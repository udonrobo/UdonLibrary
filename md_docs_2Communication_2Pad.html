<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="icon" href="Udon.png" type="image/x-icon" />
<title>UdonLibrary: PS5 コントローラー</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="toc"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectlogo">
                <a href="https://github.com/udonrobo/UdonLibrary">
                  <img alt="Logo" src="Udon.png"  />
                </a>
              </td>
              <td id="projectalign">
                <div id="projectname">UdonLibrary<span
                    id="projectnumber">&#160;1.0.0</span>
                </div>
                <div id="projectbrief">機械システム研究部 C++ ライブラリ</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- 構築: Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','検索',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_docs_2Communication_2Pad.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">読み取り中…</div>
<div class="SRStatus" id="Searching">検索中…</div>
<div class="SRStatus" id="NoMatches">一致する文字列を見つけられません</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">PS5 コントローラー</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md74"></a></p>
<p><code>PadPS5</code>クラスを用いることでメインマイコンで PS5 コントローラの情報を取得出来ます。</p>
<p>このクラスはテンプレートクラスになっており、受信クラスを指定します。CAN、I2C、E220、USB、Bluetooth などの通信方式に対応しています。</p>
<h1><a class="anchor" id="autotoc_md75"></a>
個別インクルード</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Pad_8hpp.html">Udon/Com/Pad.hpp</a>&gt;</span></div>
<div class="ttc" id="aPad_8hpp_html"><div class="ttname"><a href="Pad_8hpp.html">Pad.hpp</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md76"></a>
インスタンス化</h1>
<p><code>PadPS5</code>クラスはテンプレートクラスになっており、引数に受信クラスを指定することで通信方式を選択できます。</p>
<p>引数に指定した受信クラスを<code>PadPS5</code>クラスが継承するため、受信クラスのメンバ関数をそのまま使用できます。同様にコンストラクタも継承されます。受信クラスのテンプレート引数には <code>Message::PadPS5</code> が指定されます。</p>
<p>例えば CAN 経由でコントローラの情報を取得する場合、以下のように記述できます。</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <a class="code hl_class" href="classUdon_1_1CanBusTeensy.html">Udon::CanBusTeensy&lt;CAN1&gt;</a> bus;</div>
<div class="line"><span class="keyword">static</span> <a class="code hl_class" href="classUdon_1_1PadPS5.html">Udon::PadPS5&lt;Udon::CanReader&gt;</a> pad{ bus, <span class="keywordtype">id</span> };</div>
<div class="ttc" id="aclassUdon_1_1CanBusTeensy_html"><div class="ttname"><a href="classUdon_1_1CanBusTeensy.html">Udon::CanBusTeensy</a></div><div class="ttdoc">Teensy用 CANバスクラス</div><div class="ttdef"><b>Definition</b> CanBusTeensy.hpp:31</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html"><div class="ttname"><a href="classUdon_1_1PadPS5.html">Udon::PadPS5</a></div><div class="ttdoc">通信経由PS5コントローラークラス</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:26</div></div>
</div><!-- fragment --><p>記述が長いため、エイリアスを使用することをお勧めします。</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <a class="code hl_class" href="classUdon_1_1CanBusTeensy.html">Udon::CanBusTeensy&lt;CAN1&gt;</a> bus;</div>
<div class="line"><span class="keyword">static</span> Udon::CanPadPS5 pad{ bus, <span class="keywordtype">id</span> };</div>
</div><!-- fragment --><details >
<summary >
その他の通信方式でのエイリアス</summary>
<p></p>
<ul>
<li><p class="startli">I2C</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> Udon::I2cBus bus{ Wire };</div>
<div class="line"><span class="keyword">static</span> Udon::I2cPadPS5 pad{ bus, address };</div>
</div><!-- fragment --></li>
<li><p class="startli">E220 (無線モジュール)</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> Udon::E220PadPS5 pad({</div>
<div class="line">    .serial = Serial1,</div>
<div class="line">    .m0 = 2,</div>
<div class="line">    .m1 = 3,</div>
<div class="line">    .aux = 4,</div>
<div class="line">});</div>
</div><!-- fragment --></li>
<li><p class="startli">メインマイコンと USB ホストシールドが直接接続されている場合 (Bluetooth 使用時)</p>
<p class="startli"><a class="el" href="Udon_8hpp.html">Udon.hpp</a> とは別に <a class="el" href="PadPS5BT_8hpp.html">PadPS5BT.hpp</a> にインクルードする必要があります(依存ライブラリのサイズが大きいため)</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Udon_8hpp.html">Udon.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="PadPS5BT_8hpp.html">Udon/Com/Pad/PadPS5BT.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_class" href="classUdon_1_1PadPS5.html">Udon::PadPS5OnboardBT</a> pad;</div>
<div class="ttc" id="aPadPS5BT_8hpp_html"><div class="ttname"><a href="PadPS5BT_8hpp.html">PadPS5BT.hpp</a></div></div>
<div class="ttc" id="aUdon_8hpp_html"><div class="ttname"><a href="Udon_8hpp.html">Udon.hpp</a></div></div>
</div><!-- fragment --></li>
<li><p class="startli">メインマイコンと USB ホストシールドが直接接続されている場合 (USB 使用時)</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Udon_8hpp.html">Udon.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="PadPS5USB_8hpp.html">Udon/Com/Pad/PadPS5USB.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_class" href="classUdon_1_1PadPS5.html">Udon::PadPS5OnboardUSB</a> pad;</div>
<div class="ttc" id="aPadPS5USB_8hpp_html"><div class="ttname"><a href="PadPS5USB_8hpp.html">PadPS5USB.hpp</a></div></div>
</div><!-- fragment --></li>
<li>OpenSiv3D を使用している場合</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;PC と USB ケーブルで接続すると使用できます。 </p>
</blockquote>
<div class="fragment"><div class="line"><span class="keyword">static</span> SivPadPS5 pad;</div>
<div class="line"><span class="comment">// static SivPadPS5 pad{ index };  // 複数コントローラを使用する場合</span></div>
</div><!-- fragment --><p></p>
</details>
<h1><a class="anchor" id="autotoc_md77"></a>
通信開始 (Optional)</h1>
<p>本クラスは通信の管理は行わず、受信クラスから受け取ったデータの解析のみを行います。故に <code>begin</code> メンバ関数はありません。通信の開始処理が必要な受信クラスを使用している場合、通信開始処理を行う必要があります。</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> setup()</div>
<div class="line">{</div>
<div class="line">    pad.begin();  <span class="comment">// 受信クラスに開始処理を行うメンバ関数がある場合</span></div>
<div class="line">}</div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;<code>PadPS5</code> クラスに <code>begin</code> メンバ関数がないのに呼び出せているのは、<code>PadPS5</code> クラスが受信クラスを継承していて、受信クラスの <code>begin</code> メンバ関数を引き継いでいるためです。 </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md78"></a>
更新 (必須)</h1>
<p>ループ内で <code>update</code> メンバ関数を呼ぶ必要があります。受信クラスに <code>update</code> メンバ関数が実装されている場合、自動的に呼び出されます。</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> loop()</div>
<div class="line">{</div>
<div class="line">    pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a15b3621e40e64997b11f7998169650c9">update</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a15b3621e40e64997b11f7998169650c9"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a15b3621e40e64997b11f7998169650c9">Udon::PadPS5::update</a></div><div class="ttdeci">void update(int deadZone=20) noexcept</div><div class="ttdoc">更新</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:144</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md79"></a>
遠隔非常停止の実装</h1>
<p>ロボコンのルール上、遠隔非常停止を実装する必要があります。他を顧みず実装するなら以下のように記述できます。コントローラが接続されているかは <code>operator bool</code> によって取得できます。</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> loop()</div>
<div class="line">{</div>
<div class="line">    pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a15b3621e40e64997b11f7998169650c9">update</a>();</div>
<div class="line">    <span class="keywordflow">if</span> (pad and pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#adf05635646136035d9f097631f6f74ef">getCross</a>().<a class="code hl_variable" href="structUdon_1_1Input.html#a195035cae424cb435f087f5e8e3f7152">toggle</a>) <span class="comment">// 接続されている、×ボタンを押し非常停止が解除された場合</span></div>
<div class="line">    {</div>
<div class="line">        omni.move(stick);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        omni.stop();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_adf05635646136035d9f097631f6f74ef"><div class="ttname"><a href="classUdon_1_1PadPS5.html#adf05635646136035d9f097631f6f74ef">Udon::PadPS5::getCross</a></div><div class="ttdeci">Input getCross() const noexcept</div><div class="ttdoc">×ボタン</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:82</div></div>
<div class="ttc" id="astructUdon_1_1Input_html_a195035cae424cb435f087f5e8e3f7152"><div class="ttname"><a href="structUdon_1_1Input.html#a195035cae424cb435f087f5e8e3f7152">Udon::Input::toggle</a></div><div class="ttdeci">bool toggle</div><div class="ttdoc">トグル値</div><div class="ttdef"><b>Definition</b> Input.hpp:58</div></div>
</div><!-- fragment --><p>bool 値を複数扱うと頭が混乱するため、<code>PadPS5</code> クラスは非常停止を行うべきかを判断するための <code>isEmergencyStop</code>、また逆の動作可能かを判断するための <code>isOperable</code> メンバ関数を提供しています。内部的には上記の処理と同等です。</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> loop()</div>
<div class="line">{</div>
<div class="line">    pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a15b3621e40e64997b11f7998169650c9">update</a>();</div>
<div class="line">    <span class="keywordflow">if</span> (pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#ace71f4cab282f91ae5b6ec8d75dda23b">isOperable</a>())</div>
<div class="line">    {</div>
<div class="line">        omni.move(stick);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        omni.stop();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_ace71f4cab282f91ae5b6ec8d75dda23b"><div class="ttname"><a href="classUdon_1_1PadPS5.html#ace71f4cab282f91ae5b6ec8d75dda23b">Udon::PadPS5::isOperable</a></div><div class="ttdeci">bool isOperable() const noexcept</div><div class="ttdoc">動作可能であるか</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:70</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md80"></a>
ボタン</h1>
<p>次のようにボタンの状態を <code>Input</code> オブジェクトとして取得できます。</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> loop()</div>
<div class="line">{</div>
<div class="line">    pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a15b3621e40e64997b11f7998169650c9">update</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#aca3b8482aa61897f35178afe39f036e3">getTriangle</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a40a7d612ccfa09c17dc7bbf15c2419b3">getCircle</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#adf05635646136035d9f097631f6f74ef">getCross</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#ac2a73ad5c2f6d65d2325cf324905af93">getSquare</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#aaf6ca576f49989ab58e32c5d8265c74f">getUp</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a4c8ac2035811d3fee6fbeeb38f1ba8b6">getRight</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a08e2696e76412dca980727653e541a0c">getDown</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a65fc85d767aed800991c7110d316d7f0">getLeft</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#aff4c874caea6e0297a8da2f5b0594fdf">getL1</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#af48504e2480557afff6625eef4a6508f">getR1</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a810301cef6662eb69ce1b64d2e53e381">getL2</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#acd372dc9123f2f2c477fa5733d3ae347">getR2</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#aa611ae416604b887f877c9c5788eac27">getL3</a>();      <span class="comment">// 左スティック押し込み</span></div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a772bd397c8af31aecf0283f8cd9d5637">getR3</a>();      <span class="comment">// 右スティック押し込み</span></div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a85dd6864cf5362d2c16154995f854a45">getCreate</a>();  <span class="comment">// クリエイトボタン(左上ボタン)</span></div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#ad68ea9a0046bf8f5a306d9a411951a74">getOption</a>();  <span class="comment">// オプションボタン(右上ボタン)</span></div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#af9cd289638e14bdb26157e24a8bf6d92">getTouch</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Input.html">Udon::Input</a> input = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a217c540c0eb8c5aa8a306813dace17f3">getPs</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a08e2696e76412dca980727653e541a0c"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a08e2696e76412dca980727653e541a0c">Udon::PadPS5::getDown</a></div><div class="ttdeci">Input getDown() const noexcept</div><div class="ttdoc">十字キー下</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:94</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a217c540c0eb8c5aa8a306813dace17f3"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a217c540c0eb8c5aa8a306813dace17f3">Udon::PadPS5::getPs</a></div><div class="ttdeci">Input getPs() const noexcept</div><div class="ttdoc">PSボタン</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:130</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a40a7d612ccfa09c17dc7bbf15c2419b3"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a40a7d612ccfa09c17dc7bbf15c2419b3">Udon::PadPS5::getCircle</a></div><div class="ttdeci">Input getCircle() const noexcept</div><div class="ttdoc">○ボタン</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:79</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a4c8ac2035811d3fee6fbeeb38f1ba8b6"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a4c8ac2035811d3fee6fbeeb38f1ba8b6">Udon::PadPS5::getRight</a></div><div class="ttdeci">Input getRight() const noexcept</div><div class="ttdoc">十字キー右</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:91</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a65fc85d767aed800991c7110d316d7f0"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a65fc85d767aed800991c7110d316d7f0">Udon::PadPS5::getLeft</a></div><div class="ttdeci">Input getLeft() const noexcept</div><div class="ttdoc">十字キー左</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:97</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a772bd397c8af31aecf0283f8cd9d5637"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a772bd397c8af31aecf0283f8cd9d5637">Udon::PadPS5::getR3</a></div><div class="ttdeci">Input getR3() const noexcept</div><div class="ttdoc">右スティック押し込み</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:115</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a810301cef6662eb69ce1b64d2e53e381"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a810301cef6662eb69ce1b64d2e53e381">Udon::PadPS5::getL2</a></div><div class="ttdeci">Input getL2() const noexcept</div><div class="ttdoc">L2ボタン</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:106</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a85dd6864cf5362d2c16154995f854a45"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a85dd6864cf5362d2c16154995f854a45">Udon::PadPS5::getCreate</a></div><div class="ttdeci">Input getCreate() const noexcept</div><div class="ttdoc">クリエイトボタン(左上ボタン)</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:118</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_aa611ae416604b887f877c9c5788eac27"><div class="ttname"><a href="classUdon_1_1PadPS5.html#aa611ae416604b887f877c9c5788eac27">Udon::PadPS5::getL3</a></div><div class="ttdeci">Input getL3() const noexcept</div><div class="ttdoc">左スティック押し込み</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:112</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_aaf6ca576f49989ab58e32c5d8265c74f"><div class="ttname"><a href="classUdon_1_1PadPS5.html#aaf6ca576f49989ab58e32c5d8265c74f">Udon::PadPS5::getUp</a></div><div class="ttdeci">Input getUp() const noexcept</div><div class="ttdoc">十字キー上</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:88</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_ac2a73ad5c2f6d65d2325cf324905af93"><div class="ttname"><a href="classUdon_1_1PadPS5.html#ac2a73ad5c2f6d65d2325cf324905af93">Udon::PadPS5::getSquare</a></div><div class="ttdeci">Input getSquare() const noexcept</div><div class="ttdoc">□ボタン</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:85</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_aca3b8482aa61897f35178afe39f036e3"><div class="ttname"><a href="classUdon_1_1PadPS5.html#aca3b8482aa61897f35178afe39f036e3">Udon::PadPS5::getTriangle</a></div><div class="ttdeci">Input getTriangle() const noexcept</div><div class="ttdoc">▵ボタン</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:76</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_acd372dc9123f2f2c477fa5733d3ae347"><div class="ttname"><a href="classUdon_1_1PadPS5.html#acd372dc9123f2f2c477fa5733d3ae347">Udon::PadPS5::getR2</a></div><div class="ttdeci">Input getR2() const noexcept</div><div class="ttdoc">R2ボタン</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:109</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_ad68ea9a0046bf8f5a306d9a411951a74"><div class="ttname"><a href="classUdon_1_1PadPS5.html#ad68ea9a0046bf8f5a306d9a411951a74">Udon::PadPS5::getOption</a></div><div class="ttdeci">Input getOption() const noexcept</div><div class="ttdoc">オプションボタン(右上ボタン)</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:121</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_af48504e2480557afff6625eef4a6508f"><div class="ttname"><a href="classUdon_1_1PadPS5.html#af48504e2480557afff6625eef4a6508f">Udon::PadPS5::getR1</a></div><div class="ttdeci">Input getR1() const noexcept</div><div class="ttdoc">R1ボタン</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:103</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_af9cd289638e14bdb26157e24a8bf6d92"><div class="ttname"><a href="classUdon_1_1PadPS5.html#af9cd289638e14bdb26157e24a8bf6d92">Udon::PadPS5::getTouch</a></div><div class="ttdeci">Input getTouch() const noexcept</div><div class="ttdoc">タッチパッドボタン</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:124</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_aff4c874caea6e0297a8da2f5b0594fdf"><div class="ttname"><a href="classUdon_1_1PadPS5.html#aff4c874caea6e0297a8da2f5b0594fdf">Udon::PadPS5::getL1</a></div><div class="ttdeci">Input getL1() const noexcept</div><div class="ttdoc">L1ボタン</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:100</div></div>
<div class="ttc" id="astructUdon_1_1Input_html"><div class="ttname"><a href="structUdon_1_1Input.html">Udon::Input</a></div><div class="ttdoc">入力値</div><div class="ttdef"><b>Definition</b> Input.hpp:16</div></div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;<code>Input</code> オブジェクトは以下の様に定義されており、各ボタンの押された瞬間、離した瞬間等を取得できます。</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>Input</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">bool</span> press;    <span class="comment">// 押されているか</span></div>
<div class="line">    <span class="keywordtype">bool</span> click;    <span class="comment">// 押された瞬間か</span></div>
<div class="line">    <span class="keywordtype">bool</span> release;  <span class="comment">// 離された瞬間か</span></div>
<div class="line">    <span class="keywordtype">bool</span> toggle;   <span class="comment">// 押すごとに入れ替わる</span></div>
<div class="line">};</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// 三角ボタンが押されているか</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">bool</span> trianglePressed = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#aca3b8482aa61897f35178afe39f036e3">getTriangle</a>().<a class="code hl_variable" href="structUdon_1_1Input.html#a3dfb3b489c37ac7f1159978bb1957aed">press</a>;</div>
<div class="ttc" id="astructUdon_1_1Input_html_a3dfb3b489c37ac7f1159978bb1957aed"><div class="ttname"><a href="structUdon_1_1Input.html#a3dfb3b489c37ac7f1159978bb1957aed">Udon::Input::press</a></div><div class="ttdeci">bool press</div><div class="ttdoc">押されているか</div><div class="ttdef"><b>Definition</b> Input.hpp:46</div></div>
</div><!-- fragment --> </blockquote>
<h1><a class="anchor" id="autotoc_md81"></a>
スティック</h1>
<p>以下の関数から左右のスティックの値を <code>Vec2</code> オブジェクトして取得可能です。Vec2 クラスの詳細は <a class="el" href="md_docs_2Types_2Vector2D.html">こちら</a></p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> loop()</div>
<div class="line">{</div>
<div class="line">    pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a15b3621e40e64997b11f7998169650c9">update</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Vec2.html">Udon::Vec2</a> left  = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a6b6d64c6f7998d90565b68710efb7d18">getLeftStick</a>();</div>
<div class="line">    <a class="code hl_struct" href="structUdon_1_1Vec2.html">Udon::Vec2</a> right = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a4d45234bb4dbd3b74422fb0128b65db1">getRightStick</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a4d45234bb4dbd3b74422fb0128b65db1"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a4d45234bb4dbd3b74422fb0128b65db1">Udon::PadPS5::getRightStick</a></div><div class="ttdeci">Vec2 getRightStick() const noexcept</div><div class="ttdoc">右スティック [x,y: -255~255]</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:136</div></div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a6b6d64c6f7998d90565b68710efb7d18"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a6b6d64c6f7998d90565b68710efb7d18">Udon::PadPS5::getLeftStick</a></div><div class="ttdeci">Vec2 getLeftStick() const noexcept</div><div class="ttdoc">左スティック [x,y: -255~255]</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:133</div></div>
<div class="ttc" id="astructUdon_1_1Vec2_html"><div class="ttname"><a href="structUdon_1_1Vec2.html">Udon::Vec2</a></div><div class="ttdoc">二次元ベクトル</div><div class="ttdef"><b>Definition</b> Vector2D.hpp:22</div></div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;<code>Vec2</code> オブジェクトは以下の様に定義されており、各スティックの X, Y 軸の傾きを取得できます。スティックの上方向が X 軸の正、右方向が Y 軸の正です。</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>Vec2</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">double</span> x;  <span class="comment">// -255 ~ 255</span></div>
<div class="line">    <span class="keywordtype">double</span> y;  <span class="comment">// -255 ~ 255</span></div>
<div class="line">};</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// 左スティックのx軸の傾き</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> leftX = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a6b6d64c6f7998d90565b68710efb7d18">getLeftStick</a>().<a class="code hl_variable" href="structUdon_1_1Vec2.html#aa41b9596dd6fd8353630210413608eb4">x</a>;</div>
<div class="ttc" id="astructUdon_1_1Vec2_html_aa41b9596dd6fd8353630210413608eb4"><div class="ttname"><a href="structUdon_1_1Vec2.html#aa41b9596dd6fd8353630210413608eb4">Udon::Vec2::x</a></div><div class="ttdeci">ValueType x</div><div class="ttdoc">X成分</div><div class="ttdef"><b>Definition</b> Vector2D.hpp:28</div></div>
</div><!-- fragment --> </blockquote>
<p>また、<code>Stick</code> オブジェクトを取得できる関数もあります。<code>Stick</code> オブジェクトとはロボットの移動に必要な入力成分 (移動: 左 X,Y、旋回: 右 X) をまとめたオブジェクトで、このオブジェクトを用いてオムニホイールの出力値を求めたりすることもできます。</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structUdon_1_1Pos.html">Udon::Stick</a> stick = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a2fe0419f3bc5b65f01549ea916435f95">getMoveInfo</a>();</div>
<div class="ttc" id="aclassUdon_1_1PadPS5_html_a2fe0419f3bc5b65f01549ea916435f95"><div class="ttname"><a href="classUdon_1_1PadPS5.html#a2fe0419f3bc5b65f01549ea916435f95">Udon::PadPS5::getMoveInfo</a></div><div class="ttdeci">Stick getMoveInfo() const noexcept</div><div class="ttdoc">ロボットの移動に必要なスティックの情報 Udon::Stick オブジェクト {{x,y},turn} を取得</div><div class="ttdef"><b>Definition</b> PadPS5.hpp:140</div></div>
<div class="ttc" id="astructUdon_1_1Pos_html"><div class="ttname"><a href="structUdon_1_1Pos.html">Udon::Pos</a></div><div class="ttdoc">ロボットの位置</div><div class="ttdef"><b>Definition</b> Position.hpp:26</div></div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;<code>Stick</code> オブジェクトは以下の様に定義されています。</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>Stick</div>
<div class="line">{</div>
<div class="line">    Vec2 vector;  <span class="comment">// 平行移動成分 (左スティック)</span></div>
<div class="line">    <span class="keywordtype">double</span> turn;  <span class="comment">// 旋回成分 (右スティックのX成分)</span></div>
<div class="line">};</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// スティックからオムニの出力値を求める</span></div>
<div class="line"><span class="keyword">const</span> std::array&lt;double, 4&gt; omni = pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a2fe0419f3bc5b65f01549ea916435f95">getMoveInfo</a>().<a class="code hl_function" href="structUdon_1_1Pos.html#a187d13f2aa77ee29502c343e0666cc56">toOmni</a>();</div>
<div class="ttc" id="astructUdon_1_1Pos_html_a187d13f2aa77ee29502c343e0666cc56"><div class="ttname"><a href="structUdon_1_1Pos.html#a187d13f2aa77ee29502c343e0666cc56">Udon::Pos::toOmni</a></div><div class="ttdeci">std::array&lt; double, N &gt; toOmni() const</div><div class="ttdef"><b>Definition</b> Position.hpp:161</div></div>
</div><!-- fragment --> </blockquote>
<h1><a class="anchor" id="autotoc_md82"></a>
最終的なスケッチ例 (CAN バス経由)</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Udon_8hpp.html">Udon.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_class" href="classUdon_1_1CanBusTeensy.html">Udon::CanBusTeensy&lt;CAN1&gt;</a> bus;</div>
<div class="line"><span class="keyword">static</span> Udon::CanPadPS5 pad{ bus, 0x006 };</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup()</div>
<div class="line">{</div>
<div class="line">    Serial.begin(115200);</div>
<div class="line">    bus.<a class="code hl_function" href="classUdon_1_1CanBusTeensy.html#a634246d48d846fee09ab4c3259f18b26">begin</a>();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop()</div>
<div class="line">{</div>
<div class="line">    bus.<a class="code hl_function" href="classUdon_1_1CanBusTeensy.html#a5e0b712fc58d18f440fd3e70b2ac0100">update</a>();</div>
<div class="line">    pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a15b3621e40e64997b11f7998169650c9">update</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a40a7d612ccfa09c17dc7bbf15c2419b3">getCircle</a>().<a class="code hl_variable" href="structUdon_1_1Input.html#aa4c9c021a02823dde03ead4e3a68626e">click</a>)</div>
<div class="line">    {</div>
<div class="line">        Serial.println(<span class="stringliteral">&quot;circle clicked&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    delay(1);</div>
<div class="line">}</div>
<div class="ttc" id="aclassUdon_1_1CanBusTeensy_html_a5e0b712fc58d18f440fd3e70b2ac0100"><div class="ttname"><a href="classUdon_1_1CanBusTeensy.html#a5e0b712fc58d18f440fd3e70b2ac0100">Udon::CanBusTeensy::update</a></div><div class="ttdeci">void update()</div><div class="ttdoc">バス更新</div><div class="ttdef"><b>Definition</b> CanBusTeensy.hpp:89</div></div>
<div class="ttc" id="aclassUdon_1_1CanBusTeensy_html_a634246d48d846fee09ab4c3259f18b26"><div class="ttname"><a href="classUdon_1_1CanBusTeensy.html#a634246d48d846fee09ab4c3259f18b26">Udon::CanBusTeensy::begin</a></div><div class="ttdeci">void begin()</div><div class="ttdoc">通信開始</div><div class="ttdef"><b>Definition</b> CanBusTeensy.hpp:37</div></div>
<div class="ttc" id="astructUdon_1_1Input_html_aa4c9c021a02823dde03ead4e3a68626e"><div class="ttname"><a href="structUdon_1_1Input.html#aa4c9c021a02823dde03ead4e3a68626e">Udon::Input::click</a></div><div class="ttdeci">bool click</div><div class="ttdoc">押された瞬間か</div><div class="ttdef"><b>Definition</b> Input.hpp:52</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md83"></a>
メインマイコンと USB ホストシールドが直接接続されている場合</h1>
<p>コントローラに内蔵されている LED や、バイブレーションを動作させられます。</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Udon_8hpp.html">Udon.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_class" href="classUdon_1_1PadPS5.html">Udon::PadPS5OnboardBT</a> pad;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup()</div>
<div class="line">{</div>
<div class="line">    pad.begin();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop()</div>
<div class="line">{</div>
<div class="line">    pad.<a class="code hl_function" href="classUdon_1_1PadPS5.html#a15b3621e40e64997b11f7998169650c9">update</a>();</div>
<div class="line">    pad.setLightBar({ 0x38b48b });   <span class="comment">// タッチパネルサイドLED (色指定可能)</span></div>
<div class="line">    pad.setMicLed(<span class="keyword">true</span>);             <span class="comment">// マイクLED</span></div>
<div class="line">    pad.setPlayerLamp();             <span class="comment">// タッチパネル下部LED (5つ)</span></div>
<div class="line">    pad.vibrate(100, 100);           <span class="comment">// 左右バイブレーションモーター</span></div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! --></div>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.init()
  DoxygenAwesomeFragmentCopyButton.init()
</script>
</body>
</html>
